# CDN的原理

## 什么是CDN

`CDN`的全称是`Content Delivery Network`，即内容分发网络。

其目的是通过在现有的Internet中增加一层新的网络架构，
将网站的内容发布到最接近用户的网络“边缘”，
使用户可以就近取得所需的内容，提高用户访问网站的响应速度。
CDN有别于镜像，因为它比镜像更智能，
或者可以做这样一个比喻：CDN=更智能的镜像+缓存+流量导流。
因而，CDN可以明显提高Internet网络中信息流动的效率。
从技术上全面解决由于网络带宽小、用户访问量大、网点分布不均等问题，
提高用户访问网站的响应速度。

## CDN解决了什么问题？

一般的网络请求场景下有下面4个问题：

 1. 带宽限制。作为一个服务器，他由于受到带宽的限制，所能承受的网络并发请求量和连接数是有限的。容易成为服务能力的瓶颈
 
 2. 延时和拥塞。从客户端发起请求到服务端返回数据，中间会经过很长且复杂的网络环境，如：IDC、骨干网、城域网、接入网等，任何一个环境出现小小的问题都让这个请求发生延迟或拥塞
 
 3. 网络运营商跨越问题。有时网络请求可能从"联通"的网络到"电信"，这个可能会导致网络延迟。
 
 4. 客户端的网络限流。有时客户端的网络状况会有问题，受到终端运行商的共享带宽限制。


## CDN包括哪些技术

CDN核心技术包括：负载均衡技术、动态内容分发与复制技术和缓存技术。



### 负载均衡技术

CDN中分为服务器负载均衡和服务器全局负载均衡。

负载均衡的目的是让性能差的服务器不会成为整体系统的瓶颈，同时也要让性能好的服务器的资源能得到充分利用。

### 动态分发与复制技术

通常情况下，一个网络请求可能要经过重重的路由转发和转发才能到达最后的服务器直至请求到资源。

而动态分发与复制技术是将大部分静态资源分发复制到各地的加速节点上，以便缩短客户端与目标资源的路径。

### 缓存技术

Web缓存服务通过几种方式来改善用户的响应时间，如代理缓存服务、透明代理缓存服务、使用重定向服务的透明代理缓存服务等。
通过Web缓存服务，用户访问网页时可以将广域网的流量降至最低。
对于公司内联网用户来说，这意味着将内容在本地缓存，而无须通过专用的广域网来检索网页。
对于Internet用户来说，这意味着将内容存储在他们的ISP的缓存器中，而无须通过Internet来检索网页。
这样无疑会提高用户的访问速度。CDN的核心作用正是提高网络的访问速度，所以，缓存技术将是CDN所采用的又一个主要技术。


## 工作原理

核心工作原理是*用户和源服务器之间增加了Cache层*，实现手段是通过接管DNS，将用户的请求引导到Cache上获得源服务器的数据，从而降低网络的访问时间。

 > 传统的网络结构
![传统的网络结构](http://image.wangchong.tech/cdn%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86)

> 传统的网络结构
![CDN的DNS解析过程](http://image.wangchong.tech/cdn%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86)

可以看出，追加了一个智能调度DNS服务器。它可以根据一定的算法和策略（如静态拓扑、容量等），将最适合的CDN节点IP地址回应给LocalDns

## 参考文章

> [迄今为止最好懂的CDN原理解释！](https://www.hkt4.com/news/idc-baike/991.html)
>
> [一文看懂CDN加速原理](https://blog.csdn.net/xiangzhihong8/article/details/83147542)
